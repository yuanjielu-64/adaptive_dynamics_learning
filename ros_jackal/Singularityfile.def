Bootstrap: docker
From: ros:noetic

%setup
    mkdir -p ${APPTAINER_ROOTFS}/jackal_ws/src

%post -c /bin/bash
    # Clone the project repository

    # Update packages and install dependencies
    apt -y update; apt-get -y install \
        python3-pip \
        git \
        libprotobuf-dev \
        protobuf-compiler \
        gazebo11 \
        libgazebo11-dev \
        ros-noetic-gazebo-ros \
        ros-noetic-gazebo-ros-pkgs \
        ros-noetic-gazebo-ros-control \
        ros-noetic-tf2 \
        ros-noetic-tf2-ros \
        ros-noetic-tf2-geometry-msgs \
        ros-noetic-tf2-msgs \
        ros-noetic-tf2-eigen \
        ros-noetic-tf2-kdl \
        ros-noetic-tf2-sensor-msgs \
        ros-noetic-nmea-msgs \
        ros-noetic-roslint \
        ros-noetic-rosserial-server \
        ros-noetic-twist-mux \
        ros-noetic-hector-gazebo-plugins \
        ros-noetic-xacro \
        ros-noetic-rosdoc-lite \
        ros-noetic-teleop-twist-joy \
        ros-noetic-costmap-2d \
        ros-noetic-rviz \
        ros-noetic-robot-upstart \
        ros-noetic-jackal-simulator \
        ros-noetic-jackal-desktop \
        ros-noetic-jackal-navigation \
        ros-noetic-rosserial-python \
        ros-noetic-nmea-navsat-driver \
        && apt-get clean
    pip3 install --upgrade pip
    
    cd /jackal_ws/src
    git clone https://github.com/yuanjielu-64/adaptive_dynamics_learning.git .

    # Upgrade pip and install Python dependencies
    cd /jackal_ws/src/ros_jackal
    pip3 install -r requirements.txt
    pip3 install scipy gymnasium psutil
    
    # ROS setup
    source /opt/ros/noetic/setup.bash

